---
title: "BBoPP Lagering Masterminds"
author: "JRB"
date: "`r Sys.Date()`"
output:
  html_document:
    theme:
      bg: "#484848"
      fg: "#FDF7F7"
      primary: "#484848"
      navbar-bg: "#2e4263"
      base_font:
        google: Prompt
      heading_font:
        google: Sen
      code_font:
        google:
          family: JetBrains Mono
          local: false
    vertical_layout: scroll
---

```{r setup, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = F)

library(ggplot2)
library(shiny)
library(viridis)
library(tidyverse)
library(hrbrthemes)
library(ggalt)
library(tm)
library(wordcloud)
library(wordcloud2)
library(rsconnect)

bbopp <- 
  read.csv(
    "/Users/jrb/Desktop/R/BBoPP_data.csv",
    row.names = NULL,
    sep = ","
  )

bbopp$beer_number <- as.factor(bbopp$beer_number)

bbopp <- bbopp %>%
  group_by(beer_number) %>%
  add_count(Aroma, name = "aroma_count") %>%
  add_count(Appearance, name = "appearance_count") %>%
  add_count(Flavor, name = "flavor_count") %>%
  add_count(Mouthfeel, name = "mouthfeel_count") %>%
  add_count(Overall, name = "overall_count") %>%
  mutate(mean_aroma = mean(Aroma,na.rm=TRUE), mean_appearance = mean(Appearance,na.rm=TRUE), mean_flavor = mean(Flavor,na.rm=TRUE), mean_mouthfeel = mean(Mouthfeel,na.rm=TRUE), mean_overall = mean(Overall,na.rm=TRUE), mean_lager_ale = mean(lager_ale, na.rm=T))
```

### BBoPP Lagering Masterminds:
Using the same grain bill, we inoculated five-gallon batches with different yeast strains (ale and lager), and fermented at different temperatures. The goal is to determine if we can taste differences.

### International Pale Lager 2A BJCP Guidelines:

#### Overall Impression
A highly-attenuated pale lager without strong flavors, typically well-balanced and highly carbonated. Served cold, it is refreshing and thirst-quenching.

#### Appearance
Pale straw to gold color. White, frothy head may not be long lasting. Very clear.

#### Aroma
Low to medium-low malt aroma, which can be grainy-malty or slightly corny-sweet. Hop aroma may range from very low to a medium, spicy or floral hop presence. While a clean fermentation profile is generally most desirable, low levels of yeast character (such as a light apple fruitiness) are not a fault. A light amount of DMS or corn aroma is not a fault

#### Flavor
Low to moderate levels of grainy-malt flavor, with a crisp, dry, well-attenuated finish. The grain character can be somewhat neutral, or show a light bready-crackery quality or up to moderate corny or malty sweetness. Hop flavor ranges from none to medium levels, and often showing a floral, spicy, or herbal character if detected. Hop bitterness at medium-low to medium level. Balance may vary from slightly malty to slightly bitter, but is relatively close to even. Neutral aftertaste with light malt and sometimes hop flavors. A light amount of DMS is not a fault.

#### Mouthfeel
Light to medium body. Moderately high to highly carbonated. Can have a slight carbonic bite on the tongue.

#### Comments
International lagers tend to have fewer adjuncts than standard American lagers. They may be all-malt, although strong flavors are still a fault. A broad category of international mass-market lagers ranging from up-scale American lagers to the typical “import” or “green bottle” international beers found in America and many export markets. Often confusingly labeled as a “Pilsner.” Any skunkiness in commercial beers from being lightstruck in a green bottle is a mishandling fault, not a characteristic of the style.

#### History
In the United States, developed as a premium version of the standard American lager, with a similar history. Outside the United States, developed either as an imitation of American style lagers, or as a more accessible (and often drier and less bitter) version of a Pilsner-type beer. Often heavily marketed and exported by large industrial or multi-national breweries.

#### Style Comparison
Generally more bitter and filling than American lager. Less hoppy and bitter than a German Pils. Less body, malt flavor, and hop character than a Czech Premium Pale Lager. More robust versions can approach a Munich Helles in flavor, although with more of an adjunct quality.

#### Vital Statistics
IBU
18 - 25

SRM
2 - 6

OG
1.042 - 1.050

FG
1.008 - 1.012

ABV
4.6% - 6%

#### Commercial Examples
Asahi Super Dry, Birra Moretti, Corona Extra, Devils Backbone Gold Leaf Lager, Full Sail Session Premium Lager, Heineken, Red Stripe, Singha.

#### Style Attributes
balanced, bottom-fermented, lagered, pale-color, pale-lager-family, standard-strength, traditional-style

### Trends:

#### If we fermented a beer outside of reccomended guidelines did tasters like the beer less?
Overall scores for beers tended to cluster at higher score numbers for beers that were fermented within their prescribed temperature guidelines.

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
# Q1: if people fermented outside of temp guidelines, did we like the beer less?

ggplot(bbopp, aes(fill = fermented_outside_temp_guidelines, x = Fermentation_Temp)) +
  geom_boxplot(aes(y = Overall), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#ab47bc"
  )) +
  #facet_wrap(vars(y = Fermentation_Temp)) +
  coord_flip() +
  theme_ipsum(grid = F) +
  ylab("Overall Score") +
  xlab("Fermentation Tempretures") +
  labs(title = "Overall Scores & if Fermented by Perscribed Fermentation Tempretures") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "bottom",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

#### Did tasters prefer lagers (lager yeast; lager fermentation tempretures) to ale-tempreture fermented beers?
Overall scores clustered slightly higher for beers that fit the lager profile (yeast & fermentation temperatures), compared to ale-yeast beers fermented at ale temperatures. 

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
# Q2: did we like the traditional lagers better? Traditional = lager yeast, and fermented within temp range
p <- bbopp %>%
  drop_na(Fermentation_Temp)
  
ggplot(p, aes(fill = isLagerYeast, x = Fermentation_Temp)) +
geom_boxplot(aes(y = Overall), color = "lightgrey") +
# ggplot(p, mapping = aes(fill = isLagerYeast, x = Fermentation_Temp)) +
#   geom_point(aes(y = Overall, color = isLagerYeast), size = p$overall_count * 1.5) +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#ab47bc"
  )) +
  #facet_wrap(vars(y = fermented_outside_temp_guidelines)) +
  #coord_flip() +
  theme_ipsum(grid = F) +
  ylab("Distribution of Overall Scores") +
  xlab("Fermentation Tempretures") +
  labs(title = "Overall Scores by Fermentation Tempreture & if Lager Yeast") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "bottom",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

#### Did tasters score beers higher when the beers were lager-yeast, and lager-tempretures?
Meh, not so much. 

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
# Q3: could we tell any difference between lagers and ales? Something is a lager if 1) yeast is lager, 2) and fermented within recommended temp. we thought it was a lager if it scored 0 to 3 on lager ale scale. 
# x = beer number; y = mean overall (as size), color = isLager

bbopp$isLager = ifelse((bbopp$isLagerYeast == "yes" & bbopp$fermented_outside_temp_guidelines == "No"), "Yes", "No")

ggplot(bbopp, aes(fill = isLager, x = isLager)) +
  stat_boxplot(aes(y = Overall), color = "lightgrey", outliers = T) +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#ab47bc"
  )) +
  theme_ipsum(grid = F) +
  coord_flip() +
  ylab("Distribution of Overall Scores") +
  xlab("If Beer is a Lager") +
  labs(title = "Distribution of Overall Scores & if Beer is a Lager", subtitle = "Lager = Lager Yeast & Fermented within Recommended Temperature Range") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "bottom",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

#### Did tasters rate beers differently if the beers were fermented outside of their recommended tempretures?
Yes. The mystery temperature beer scored the highest. Of known fermentation temperature beers, there was a preference for beers fermented within prescribed temperatures. 

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
# Q4: overall score by fermented_outside_of_temps

ggplot(bbopp, aes(fill = fermented_outside_temp_guidelines, x = fermented_outside_temp_guidelines)) +
  geom_boxplot(aes(y = Overall, color = bbopp$fermented_outside_temp_guidelines), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#26c6da",
    "#ab47bc"
  )) +
  theme_ipsum(grid = F) +
  coord_flip() +
  ylab("Distribution of Overall Scores") +
  xlab("If Fermented Outside of Recommended Yeast Temperatures") +
  labs(title = "Distribution of Overall Scores & if Beer Fermented Outside of Recommended Temperatures") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "bottom",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

#### Did tasters prefer beers fermented with lager yeast rather than ale yeast?
Yes!

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
# Q5: overall score by isLagerYeast
ggplot(bbopp, aes(fill = isLagerYeast, x = isLagerYeast)) +
  geom_boxplot(aes(y = Overall, color = bbopp$isLagerYeast), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    #"#26c6da",
    "#ab47bc"
  )) +
  coord_flip() +
  theme_ipsum(grid = F) +
  ylab("Distribution of Overall Scores") +
  xlab("If Fermented with Lager Yeast") +
  labs(title = "Distribution of Overall Scores & if Lager Yeast") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "bottom",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

#### Did tasters rater beers higher if those beers were fermented well within tempreture guidelines?
Not really.

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
# Q6: compare scores by fermented temp v recommended temp. size = overall; x = ferment temp, y = min recommended temp

ggplot(bbopp, aes(y = mean_overall))+
  geom_linerange(aes(xmin = min_temp,xmax = max_temp),linetype=1,color="black") +
  geom_point(aes(x = Fermentation_Temp, color = beer_number),size=3) +
  scale_colour_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#29b6f6",
    "#42a5f5",
    "#5c6bc0",
    "#7e57c2",
    "#ab47bc"
  )) +
  theme_ipsum(grid = F) +
  coord_flip() +
  xlab("Fermentation Temperature") +
  ylab("Mean Overall Score by Beer") +
  labs(title = "Mean Overall Score by Fermentation Temp & If Fermented within Temp Guidelines") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "bottom",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

### All Beers {.tabset} 

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
ggplot(bbopp, aes(x = beer_number, fill = Yeast)) +
  geom_boxplot(aes(y = Aroma, color = Yeast), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  theme_ipsum(grid = F) +
  ylab("Aroma Score") +
  xlab("Beer Number") +
  labs(title = "Distribution of Aroma Scores by Beer Number") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "right",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
# ggplot(bbopp, aes(x = beer_number, y = Appearance)) +
#   geom_boxplot(aes(fill = Yeast), color = "lightgrey") +
#   #geom_point(aes(fill = Yeast)) +
#   scale_fill_manual(values = c(
#     "#9ccc65",
#     "#66bb6a",
#     "#26a69a",
#     "#26c6da",
#     "#7e57c2",
#     "#ab47bc"
#   )) +
#   #facet_grid(Yeast~.) +
#   coord_cartesian(y = c(1,3)) +
# # ggplot(bbopp, aes(x = beer_number, fill = Yeast)) +
# #   geom_boxplot(aes(y = Appearance, color = Yeast), color = "lightgrey") +
# #   scale_fill_manual(values = c(
# #     "#9ccc65",
# #     "#66bb6a",
# #     "#26a69a",
# #     "#26c6da",
# #     "#7e57c2",
# #     "#ab47bc"
# #   )) +
#   theme_ipsum(grid = F) +
#   ylab("Appearance Score") +
#   xlab("Beer Number") +
#   labs(title = "Appearance") +
#   theme(
#     plot.background = element_rect(fill = "#484848"),
#     axis.text.x = element_text(
#       vjust = 1,
#       hjust = 1,
#       color = "#85C8CD"
#     ),
#     axis.text.y = element_text(color = "#85C8CD", size = 14),
#     legend.text = element_text(colour = "#85C8CD", size = 14),
#     legend.position = "right",
#     legend.title = element_text(color = "#85C8CD"),
#     axis.title.x = element_text(colour = "#85C8CD", size = 14),
#     axis.title.y = element_text(colour = "#85C8CD", size = 14),
#     title = element_text(
#       colour = "#85C8CD",
#       size = 16,
#       hjust = 0.5
#     )
#   )

ggplot(bbopp, mapping = aes(x = beer_number)) +
  geom_point(aes(y = Appearance, color = Yeast), size = bbopp$appearance_count * 1.5) +
  #geom_boxplot(aes(y = Appearance, color = Yeast)) +
  scale_colour_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  geom_point(
    aes(y = mean_appearance, fill = 'Mean Appearance'),
    color = "white",
    shape = 15,
    size = 5,
    stat = 'identity'
  ) +
  scale_fill_manual(name = '', values = 'skyblue') +
  theme_ipsum(grid = F) +
  ylab("Appearance Score") +
  xlab("Beer Number") +
  labs(title = "Distribution of Appearance Scores by Beer Number") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "right",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )

```

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
ggplot(bbopp, aes(x = beer_number, fill = Yeast)) +
  geom_boxplot(aes(y = Flavor, color = Yeast), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  theme_ipsum(grid = F) +
  ylab("Flavo(u)r Score") +
  xlab("Beer Number") +
  labs(title = "Distribution of Flavo(u)r Scores by Beer Number") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "right",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
# ggplot(bbopp, aes(x = beer_number, fill = Yeast)) +
#   geom_boxplot(aes(y = Mouthfeel, color = Yeast), color = "lightgrey") +
#   scale_fill_manual(values = c(
#     "#9ccc65",
#     "#66bb6a",
#     "#26a69a",
#     "#26c6da",
#     "#7e57c2",
#     "#ab47bc"
#   )) +
#   theme_ipsum(grid = F) +
#   ylab("Mouthfeel Score") +
#   xlab("Beer Number") +
#   labs(title = "Mouthfeel") +
#   theme(
#     plot.background = element_rect(fill = "#484848"),
#     axis.text.x = element_text(
#       vjust = 1,
#       hjust = 1,
#       color = "#85C8CD"
#     ),
#     axis.text.y = element_text(color = "#85C8CD", size = 14),
#     legend.text = element_text(colour = "#85C8CD", size = 14),
#     legend.position = "right",
#     legend.title = element_text(color = "#85C8CD"),
#     axis.title.x = element_text(colour = "#85C8CD", size = 14),
#     axis.title.y = element_text(colour = "#85C8CD", size = 14),
#     title = element_text(
#       colour = "#85C8CD",
#       size = 16,
#       hjust = 0.5
#     )
#   )

ggplot(bbopp, mapping = aes(x = beer_number)) +
  geom_point(aes(y = Mouthfeel, color = Yeast), size = bbopp$mouthfeel_count * 1.5) +
  scale_colour_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  geom_point(
    aes(y = mean_mouthfeel, fill = 'Mean Mouthfeel'),
    color = "white",
    shape = 15,
    size = 5,
    stat = 'identity'
  ) +
  scale_fill_manual(name = '', values = 'skyblue') +
  theme_ipsum(grid = F) +
  ylab("Mouthfeel Score") +
  xlab("Beer Number") +
  labs(title = "Distribution of Mouthfeel Scores by Beer Number") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "right",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
ggplot(bbopp, aes(x = beer_number, fill = Yeast)) +
  geom_boxplot(aes(y = Overall, color = Yeast), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  theme_ipsum(grid = F) +
  ylab("Overall Score") +
  xlab("Beer Number") +
  labs(title = "Distribution of Overall Scores by Beer Number") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "right",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
ggplot(bbopp, aes(x = beer_number, fill = Yeast)) +
  geom_boxplot(aes(y = Total, color = Yeast), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  theme_ipsum(grid = F) +
  ylab("Total Score") +
  xlab("Beer Number") +
  labs(title = "Distribution of Total Score by Beer Number") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "right",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
ggplot(bbopp, aes(x = Technique, fill = Technique)) +
  geom_violin(aes(y = lager_ale), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    #"#66bb6a",
   # "#26a69a",
    "#26c6da",
   # "#7e57c2",
    "#ab47bc"
  )) +
  coord_flip() +
  geom_vline(
    xintercept = -1,
    lwd = .5,
    colour = "#6db1c8",
    alpha = .7
  ) +
  ggplot2::annotate(
    "text",
    x = 1,
    y = 0,
    label = "Lager",
    color = "#85C8CD"
  ) +
  ggplot2::annotate(
    "text",
    y = 7,
    x = 1,
    label = "Ale",
    color = "#85C8CD"
  ) +
  theme_ipsum(grid = F) +
  xlab("Technique") +
  labs(title = "Distribution of Lager-to-Ale Scores by Technique") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "right",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )

ggplot(bbopp, aes(x = Technique, fill = Technique)) +
  geom_violin(aes(y = dry_crisp), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    #"#66bb6a",
   # "#26a69a",
    "#26c6da",
   # "#7e57c2",
    "#ab47bc"
  )) +
  coord_flip() +
  geom_vline(
    xintercept = -1,
    lwd = .5,
    colour = "#6db1c8",
    alpha = .7
  ) +
  ggplot2::annotate(
    "text",
    x = 1,
    y = 0,
    label = "Dry",
    color = "#85C8CD"
  ) +
  ggplot2::annotate(
    "text",
    y = 7,
    x = 1,
    label = "Crisp",
    color = "#85C8CD"
  ) +
  theme_ipsum(grid = F) +
  xlab("Technique") +
  labs(title = "Distribution of Dry-to-Crisp Scores by Technique") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "right",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )

# mean lager_ale by beer plotted against ferm temp
# ggplot(bbopp, aes(x = Fermentation_Temp, color = Technique)) +
#   geom_point(aes(y = mean_lager_ale), size = 4) +
#   scale_color_manual(values = c(
#     "#9ccc65",
#     #"#66bb6a",
#    # "#26a69a",
#     "#26c6da",
#    # "#7e57c2",
#     "#ab47bc"
#   )) +
#   theme_ipsum(grid = F) +
#   xlab("Temp") +
#   labs(title = "Lager-to-Ale Spectrum") +
#   theme(
#     plot.background = element_rect(fill = "#484848"),
#     axis.text.x = element_text(
#       vjust = 1,
#       hjust = 1,
#       color = "#85C8CD"
#     ),
#     axis.text.y = element_text(color = "#85C8CD", size = 14),
#     legend.text = element_text(colour = "#85C8CD", size = 14),
#     legend.position = "right",
#     legend.title = element_text(color = "#85C8CD"),
#     axis.title.x = element_text(colour = "#85C8CD", size = 14),
#     axis.title.y = element_text(colour = "#85C8CD", size = 14),
#     title = element_text(
#       colour = "#85C8CD",
#       size = 16,
#       hjust = 0.5
#     )
#   )
```

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
ggplot(bbopp, aes(x = beer_number, fill = Technique)) +
  geom_boxplot(aes(y = lager_ale, color = Technique), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    #"#66bb6a",
   # "#26a69a",
    "#26c6da",
   # "#7e57c2",
    "#ab47bc"
  )) +
  coord_flip() +
  geom_vline(
    xintercept = -1,
    lwd = .5,
    colour = "#6db1c8",
    alpha = .7
  ) +
  ggplot2::annotate(
    "text",
    x = 1,
    y = 0,
    label = "Lager",
    color = "#85C8CD"
  ) +
  ggplot2::annotate(
    "text",
    y = 7,
    x = 1,
    label = "Ale",
    color = "#85C8CD"
  ) +
  theme_ipsum(grid = F) +
  xlab("Beer Number") +
  labs(title = "Distribution of Lager-to-Ale Scores by Beer Number") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "right",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )

ggplot(bbopp, aes(x = beer_number, fill = as.factor(Fermentation_Temp))) +
  geom_boxplot(aes(y = lager_ale, color = as.factor(Fermentation_Temp)), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  coord_flip() +
  geom_vline(
    xintercept = -1,
    lwd = .5,
    colour = "#6db1c8",
    alpha = .7
  ) +
  ggplot2::annotate(
    "text",
    x = 1,
    y = 0,
    label = "Lager",
    color = "#85C8CD"
  ) +
  ggplot2::annotate(
    "text",
    y = 7,
    x = 1,
    label = "Ale",
    color = "#85C8CD"
  ) +
  theme_ipsum(grid = F) +
  xlab("Beer Number") +
  labs(title = "Distribution of Lager-to-Ale Scores by Fermentation Temperature") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "right",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```
  
```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
ggplot(bbopp, aes(x = beer_number, fill = Technique)) +
  geom_boxplot(aes(y = dry_crisp, color = Technique), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    #"#66bb6a",
   # "#26a69a",
    "#26c6da",
   # "#7e57c2",
    "#ab47bc"
  )) +
  coord_flip() +
  geom_vline(
    xintercept = -1,
    lwd = .5,
    colour = "#6db1c8",
    alpha = .7
  ) +
  ggplot2::annotate(
    "text",
    x = 1,
    y = 0,
    label = "Dry",
    color = "#85C8CD"
  ) +
  ggplot2::annotate(
    "text",
    y = 6,
    x = 1,
    label = "Crisp",
    color = "#85C8CD"
  ) +
  theme_ipsum(grid = F) +
  xlab("Beer Number") +
  labs(title = "Distribution of Dry-to-Crisp Scores by Beer Number & Actual Technnique") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "right",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )

ggplot(bbopp, aes(x = beer_number, fill = as.factor(Fermentation_Temp))) +
  geom_boxplot(aes(y = dry_crisp, color = as.factor(Fermentation_Temp)), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  coord_flip() +
  geom_vline(
    xintercept = -1,
    lwd = .5,
    colour = "#6db1c8",
    alpha = .7
  ) +
  ggplot2::annotate(
    "text",
    x = 1,
    y = 0,
    label = "Dry",
    color = "#85C8CD"
  ) +
  ggplot2::annotate(
    "text",
    y = 6,
    x = 1,
    label = "Crisp",
    color = "#85C8CD"
  ) +
  theme_ipsum(grid = F) +
  xlab("Beer Number") +
  labs(title = "Distribution of Dry-to-Crisp Scores by Fermentation Temperature & Beer Number") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "right",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
#geom_point(aes(y = Aroma, color = Yeast), size = bbopp$appearance_count * 1.5) +
#   scale_colour_manual(values = c(
  
ggplot(bbopp, mapping = aes(x = beer_number)) +
  geom_point(
    aes(y = OG, color = "OG"),
    shape = 15,
    size = 5
    ) +
  geom_point(
    aes(y = FG, color = "FG"),
    shape = 15,
    size = 5
  ) +
  theme_ipsum(grid = F) +
  ylab("Specific Gravity") +
  xlab("Beer Number") +
  labs(title = "Specific Gravity by Beer Number") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "right",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

## Beer 1 {.tabset} 

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
bbopp$beer_number <- as.numeric(bbopp$beer_number)
beer1 <- bbopp %>%
  filter(beer_number == 1) %>%
  pivot_longer(cols = 2:6)

ov_colors <-
  c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )

word2 <- beer1 %>%
  pivot_longer(
    cols = Comments,
    names_to = "comments",
    values_to = "text",
    values_drop_na = T
  ) %>%
  drop_na()

# changed "Corpus" to "VCorpus"
docs <-
  tm::VCorpus(tm::VectorSource(word2$text), readerControl = list(language =
                                                                   "en"))

toSpace <-
  content_transformer(function (x , pattern)
    gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "/")
docs <- tm_map(docs, toSpace, "@")
docs <- tm_map(docs, toSpace, "\\|")

# Convert the text to lower case
docs <- tm_map(docs, content_transformer(tolower))
# Remove numbers
docs <- tm_map(docs, removeNumbers)
# Remove english common stopwords
docs <- tm_map(docs, removeWords, stopwords("en"))

# specify stopwords as a character vector
docs <-
  tm_map(
    docs,
    removeWords,
    c(
      "the",
      "and",
      "pur",
      "her",
      "his",
      "were",
      "she",
      "he",
      "him",
      "could",
      "which",
      "when",
      "did",
      "had",
      "went",
      "they",
      "any",
      "because",
      "all",
      "than",
      "ani",
      "also",
      "where",
      "been",
      "them",
      "than",
      "why",
      "only",
      "has",
      "very",
      "have",
      "through",
      "per",
      "does",
      "within",
      "stated",
      "get"
    )
  ) 

# Remove punctuation
docs <- tm_map(docs, removePunctuation)
# Eliminate extra white spaces
docs <- tm_map(docs, stripWhitespace)

dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m), decreasing = TRUE)
d <- data.frame(word = names(v), freq = v)

set.seed(1234)

wordcloud2(data = d,
           backgroundColor = "#484848",
           color = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  ))

#########
ggplot(beer1, aes(color = name, fill = name)) +
  geom_boxplot(aes(x = name, y = value, color = name, fill = name), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  coord_flip() +
  theme_ipsum(grid = F) +
  ylab("Scores") +
  xlab("") +
  labs(title = "Beer 1 Scores") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "none",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

## Beer 2 {.tabset} 

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
bbopp$beer_number <- as.numeric(bbopp$beer_number)
beer2 <- bbopp %>%
  filter(beer_number == 2) %>%
  pivot_longer(cols = 2:6)

ov_colors <-
  c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )

word2 <- beer2 %>%
  pivot_longer(
    cols = Comments,
    names_to = "comments",
    values_to = "text",
    values_drop_na = T
  ) %>%
  drop_na()

# changed "Corpus" to "VCorpus"
docs <-
  tm::VCorpus(tm::VectorSource(word2$text), readerControl = list(language =
                                                                   "en"))
toSpace <-
  content_transformer(function (x , pattern)
    gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "/")
docs <- tm_map(docs, toSpace, "@")
docs <- tm_map(docs, toSpace, "\\|")

# Convert the text to lower case
docs <- tm_map(docs, content_transformer(tolower))
# Remove numbers
docs <- tm_map(docs, removeNumbers)
# Remove english common stopwords
docs <- tm_map(docs, removeWords, stopwords("en"))

# specify stopwords as a character vector
docs <-
  tm_map(
    docs,
    removeWords,
    c(
      "the",
      "and",
      "pur",
      "her",
      "his",
      "were",
      "she",
      "he",
      "him",
      "could",
      "which",
      "when",
      "did",
      "had",
      "went",
      "they",
      "any",
      "because",
      "all",
      "than",
      "ani",
      "also",
      "where",
      "been",
      "them",
      "than",
      "why",
      "only",
      "has",
      "very",
      "have",
      "through",
      "per",
      "does",
      "within",
      "stated",
      "get"
    )
  ) 

# Remove punctuation
docs <- tm_map(docs, removePunctuation)
# Eliminate extra white spaces
docs <- tm_map(docs, stripWhitespace)

dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m), decreasing = TRUE)
e <- data.frame(word = names(v), freq = v)

set.seed(1234)

wordcloud2(data = e,
           backgroundColor = "#484848",
           color = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  ))

#########
ggplot(beer2, aes(color = name, fill = name)) +
  geom_boxplot(aes(x = name, y = value, color = name, fill = name), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  coord_flip() +
  theme_ipsum(grid = F) +
  ylab("Scores") +
  xlab("") +
  labs(title = "Beer 2 Scores") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "none",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

## Beer 3 {.tabset} 

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
bbopp$beer_number <- as.numeric(bbopp$beer_number)
beer3 <- bbopp %>%
  filter(beer_number == 3) %>%
  pivot_longer(cols = 2:6)

ov_colors <-
  c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )

word2 <- beer3 %>%
  pivot_longer(
    cols = Comments,
    names_to = "comments",
    values_to = "text",
    values_drop_na = T
  ) %>%
  drop_na()

# changed "Corpus" to "VCorpus"
docs <-
  tm::VCorpus(tm::VectorSource(word2$text), readerControl = list(language =
                                                                   "en"))
toSpace <-
  content_transformer(function (x , pattern)
    gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "/")
docs <- tm_map(docs, toSpace, "@")
docs <- tm_map(docs, toSpace, "\\|")

# Convert the text to lower case
docs <- tm_map(docs, content_transformer(tolower))
# Remove numbers
docs <- tm_map(docs, removeNumbers)
# Remove english common stopwords
docs <- tm_map(docs, removeWords, stopwords("en"))

# specify stopwords as a character vector
docs <-
  tm_map(
    docs,
    removeWords,
    c(
      "the",
      "and",
      "pur",
      "her",
      "his",
      "were",
      "she",
      "he",
      "him",
      "could",
      "which",
      "when",
      "did",
      "had",
      "went",
      "they",
      "any",
      "because",
      "all",
      "than",
      "ani",
      "also",
      "where",
      "been",
      "them",
      "than",
      "why",
      "only",
      "has",
      "very",
      "have",
      "through",
      "per",
      "does",
      "within",
      "stated",
      "get"
    )
  ) 

# Remove punctuation
docs <- tm_map(docs, removePunctuation)
# Eliminate extra white spaces
docs <- tm_map(docs, stripWhitespace)

dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m), decreasing = TRUE)
f <- data.frame(word = names(v), freq = v)

set.seed(1234)

wordcloud2(data = f,
           backgroundColor = "#484848",
           color = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  ))

#########
ggplot(beer3, aes(color = name, fill = name)) +
  geom_boxplot(aes(x = name, y = value, color = name, fill = name), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  coord_flip() +
  theme_ipsum(grid = F) +
  ylab("Scores") +
  xlab("") +
  labs(title = "Beer 3 Scores") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "none",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

## Beer 4 {.tabset} 

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
bbopp$beer_number <- as.numeric(bbopp$beer_number)
beer4 <- bbopp %>%
  filter(beer_number == 4) %>%
  pivot_longer(cols = 2:6)

ov_colors <-
  c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )

word2 <- beer4 %>%
  pivot_longer(
    cols = Comments,
    names_to = "comments",
    values_to = "text",
    values_drop_na = T
  ) %>%
  drop_na()

# changed "Corpus" to "VCorpus"
docs <-
  tm::VCorpus(tm::VectorSource(word2$text), readerControl = list(language =
                                                                   "en"))
toSpace <-
  content_transformer(function (x , pattern)
    gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "/")
docs <- tm_map(docs, toSpace, "@")
docs <- tm_map(docs, toSpace, "\\|")

# Convert the text to lower case
docs <- tm_map(docs, content_transformer(tolower))
# Remove numbers
docs <- tm_map(docs, removeNumbers)
# Remove english common stopwords
docs <- tm_map(docs, removeWords, stopwords("en"))

# specify stopwords as a character vector
docs <-
  tm_map(
    docs,
    removeWords,
    c(
      "the",
      "and",
      "pur",
      "her",
      "his",
      "were",
      "she",
      "he",
      "him",
      "could",
      "which",
      "when",
      "did",
      "had",
      "went",
      "they",
      "any",
      "because",
      "all",
      "than",
      "ani",
      "also",
      "where",
      "been",
      "them",
      "than",
      "why",
      "only",
      "has",
      "very",
      "have",
      "through",
      "per",
      "does",
      "within",
      "stated",
      "get"
    )
  ) 

# Remove punctuation
docs <- tm_map(docs, removePunctuation)
# Eliminate extra white spaces
docs <- tm_map(docs, stripWhitespace)

dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m), decreasing = TRUE)
g <- data.frame(word = names(v), freq = v)

set.seed(1234)

wordcloud2(data = g,
           backgroundColor = "#484848",
           color = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  ))

#########
ggplot(beer4, aes(color = name, fill = name)) +
  geom_boxplot(aes(x = name, y = value, color = name, fill = name), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  coord_flip() +
  theme_ipsum(grid = F) +
  ylab("Scores") +
  xlab("") +
  labs(title = "Beer 4 Scores") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "none",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

## Beer 5 {.tabset} 

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
bbopp$beer_number <- as.numeric(bbopp$beer_number)
beer5 <- bbopp %>%
  filter(beer_number == 5) %>%
  pivot_longer(cols = 2:6)

ov_colors <-
  c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )

word2 <- beer5 %>%
  pivot_longer(
    cols = Comments,
    names_to = "comments",
    values_to = "text",
    values_drop_na = T
  ) %>%
  drop_na()

# changed "Corpus" to "VCorpus"
docs <-
  tm::VCorpus(tm::VectorSource(word2$text), readerControl = list(language =
                                                                   "en"))
toSpace <-
  content_transformer(function (x , pattern)
    gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "/")
docs <- tm_map(docs, toSpace, "@")
docs <- tm_map(docs, toSpace, "\\|")

# Convert the text to lower case
docs <- tm_map(docs, content_transformer(tolower))
# Remove numbers
docs <- tm_map(docs, removeNumbers)
# Remove english common stopwords
docs <- tm_map(docs, removeWords, stopwords("en"))

# specify stopwords as a character vector
docs <-
  tm_map(
    docs,
    removeWords,
    c(
      "the",
      "and",
      "pur",
      "her",
      "his",
      "were",
      "she",
      "he",
      "him",
      "could",
      "which",
      "when",
      "did",
      "had",
      "went",
      "they",
      "any",
      "because",
      "all",
      "than",
      "ani",
      "also",
      "where",
      "been",
      "them",
      "than",
      "why",
      "only",
      "has",
      "very",
      "have",
      "through",
      "per",
      "does",
      "within",
      "stated",
      "get"
    )
  ) 

# Remove punctuation
docs <- tm_map(docs, removePunctuation)
# Eliminate extra white spaces
docs <- tm_map(docs, stripWhitespace)

dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m), decreasing = TRUE)
h <- data.frame(word = names(v), freq = v)

set.seed(1234)

wordcloud2(data = h,
           backgroundColor = "#484848",
           color = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  ))

#########
ggplot(beer5, aes(color = name, fill = name)) +
  geom_boxplot(aes(x = name, y = value, color = name, fill = name), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  coord_flip() +
  theme_ipsum(grid = F) +
  ylab("Scores") +
  xlab("") +
  labs(title = "Beer 5 Scores") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "none",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

## Beer 6 {.tabset} 

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
bbopp$beer_number <- as.numeric(bbopp$beer_number)
beer6 <- bbopp %>%
  filter(beer_number == 6) %>%
  pivot_longer(cols = 2:6)

ov_colors <-
  c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )

word2 <- beer6 %>%
  pivot_longer(
    cols = Comments,
    names_to = "comments",
    values_to = "text",
    values_drop_na = T
  ) %>%
  drop_na()

# changed "Corpus" to "VCorpus"
docs <-
  tm::VCorpus(tm::VectorSource(word2$text), readerControl = list(language =
                                                                   "en"))
toSpace <-
  content_transformer(function (x , pattern)
    gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "/")
docs <- tm_map(docs, toSpace, "@")
docs <- tm_map(docs, toSpace, "\\|")

# Convert the text to lower case
docs <- tm_map(docs, content_transformer(tolower))
# Remove numbers
docs <- tm_map(docs, removeNumbers)
# Remove english common stopwords
docs <- tm_map(docs, removeWords, stopwords("en"))

# specify stopwords as a character vector
docs <-
  tm_map(
    docs,
    removeWords,
    c(
      "the",
      "and",
      "pur",
      "her",
      "his",
      "were",
      "she",
      "he",
      "him",
      "could",
      "which",
      "when",
      "did",
      "had",
      "went",
      "they",
      "any",
      "because",
      "all",
      "than",
      "ani",
      "also",
      "where",
      "been",
      "them",
      "than",
      "why",
      "only",
      "has",
      "very",
      "have",
      "through",
      "per",
      "does",
      "within",
      "stated",
      "get"
    )
  ) 

# Remove punctuation
docs <- tm_map(docs, removePunctuation)
# Eliminate extra white spaces
docs <- tm_map(docs, stripWhitespace)

dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m), decreasing = TRUE)
i <- data.frame(word = names(v), freq = v)

set.seed(1234)

wordcloud2(data = i,
           backgroundColor = "#484848",
           color = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  ))

#########
ggplot(beer6, aes(color = name, fill = name)) +
  geom_boxplot(aes(x = name, y = value, color = name, fill = name), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  coord_flip() +
  theme_ipsum(grid = F) +
  ylab("Scores") +
  xlab("") +
  labs(title = "Beer 6 Scores") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "none",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```

## Beer 7 {.tabset} 

```{r, fig.width= 10, fig.height= 6, warning=FALSE, echo=FALSE}
bbopp$beer_number <- as.numeric(bbopp$beer_number)
beer7 <- bbopp %>%
  filter(beer_number == 7) %>%
  pivot_longer(cols = 2:6)

ov_colors <-
  c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )

word2 <- beer7 %>%
  pivot_longer(
    cols = Comments,
    names_to = "comments",
    values_to = "text",
    values_drop_na = T
  ) %>%
  drop_na()

# changed "Corpus" to "VCorpus"
docs <-
  tm::VCorpus(tm::VectorSource(word2$text), readerControl = list(language =
                                                                   "en"))
toSpace <-
  content_transformer(function (x , pattern)
    gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "/")
docs <- tm_map(docs, toSpace, "@")
docs <- tm_map(docs, toSpace, "\\|")

# Convert the text to lower case
docs <- tm_map(docs, content_transformer(tolower))
# Remove numbers
docs <- tm_map(docs, removeNumbers)
# Remove english common stopwords
docs <- tm_map(docs, removeWords, stopwords("en"))

# specify stopwords as a character vector
docs <-
  tm_map(
    docs,
    removeWords,
    c(
      "the",
      "and",
      "pur",
      "her",
      "his",
      "were",
      "she",
      "he",
      "him",
      "could",
      "which",
      "when",
      "did",
      "had",
      "went",
      "they",
      "any",
      "because",
      "all",
      "than",
      "ani",
      "also",
      "where",
      "been",
      "them",
      "than",
      "why",
      "only",
      "has",
      "very",
      "have",
      "through",
      "per",
      "does",
      "within",
      "stated",
      "get"
    )
  ) 

# Remove punctuation
docs <- tm_map(docs, removePunctuation)
# Eliminate extra white spaces
docs <- tm_map(docs, stripWhitespace)

dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m), decreasing = TRUE)
j <- data.frame(word = names(v), freq = v)

set.seed(1234)

wordcloud2(data = j,
           backgroundColor = "#484848",
           color = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  ))

#########
ggplot(beer7, aes(color = name, fill = name)) +
  geom_boxplot(aes(x = name, y = value, color = name, fill = name), color = "lightgrey") +
  scale_fill_manual(values = c(
    "#9ccc65",
    "#66bb6a",
    "#26a69a",
    "#26c6da",
    "#7e57c2",
    "#ab47bc"
  )) +
  coord_flip() +
  theme_ipsum(grid = F) +
  ylab("Scores") +
  xlab("") +
  labs(title = "Beer 7 Scores") +
  theme(
    plot.background = element_rect(fill = "#484848"),
    axis.text.x = element_text(
      vjust = 1,
      hjust = 1,
      color = "#85C8CD"
    ),
    axis.text.y = element_text(color = "#85C8CD", size = 14),
    legend.text = element_text(colour = "#85C8CD", size = 14),
    legend.position = "none",
    legend.title = element_text(color = "#85C8CD"),
    axis.title.x = element_text(colour = "#85C8CD", size = 14),
    axis.title.y = element_text(colour = "#85C8CD", size = 14),
    title = element_text(
      colour = "#85C8CD",
      size = 16,
      hjust = 0.5
    )
  )
```